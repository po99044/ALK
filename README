# Functional atlas of ALK kinase domain variants â€“ analysis code

This repository contains custom Python code used to process amplicon NGS data and to reproduce downstream analyses/figures for the manuscript:
**"A comprehensive functional atlas of ALK kinase domain variants reveals resistance landscape to ALK inhibitor"**.

## Overview of pipeline
1. **FASTQ parsing and trimmed read counting (custom code)**  
   Amplicon FASTQ reads are scanned for a forward-primer seed (first 10 nt of the exon reference), and a fixed-length sequence segment is extracted and counted. Indel-length reads are excluded by enforcing the expected length.

2. **Variant-level count table generation (custom code)**  
   Trimmed read counts are mapped onto library barcode tables (e.g., `ALK_E23_aa.csv`) and exported as count matrices.

3. **Downstream analyses**  
   Additional scripts compute RPM/log2 fold-change and support analysis/figure generation for drug resistance and ALK dependence.

## Installation
### Option A: conda (recommended)
```bash
conda env create -f environment.yml
conda activate alk-variant-atlas
